const fs = require('fs')
const shell = require('shelljs')
const colors = require('colors')

const timeNow = require('./time-now.js')
const applyDefaults = require('./apply-defaults.js')

module.exports = (_dir, _options) => {
	_defaults = {
		'generate_indexhtml': false,
		'log_action': false
	}
	let options = applyDefaults(_options, _defaults);

	let generateDir = (_dir) => {
		if (!fs.existsSync(_dir)) {
			shell.mkdir('-p', _dir);

			// console.log(_dir.split('/'))

			if (options.generate_indexhtml) {
				fs.writeFileSync(_dir + '/' + 'index.html', '');
			}

			if (options.log_action) {
				console.log(
					'[' + timeNow().dim + '] '
					+ _dir.italic + ' created'.green
				)
			}
		} else if (options.generate_indexhtml) {
			if (!fs.existsSync(_dir + '/' + 'index.html')) {
				fs.writeFileSync(_dir + '/' + 'index.html', '');
			}
		}
	}

	if ( _dir instanceof Array ) {
		for (let i = 0, dirLen = _dir.length; i < dirLen; i++) {
			generateDir(_dir[i])
		}
	} else {
		generateDir(_dir)
	}
}