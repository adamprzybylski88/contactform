const applyDefaults = require('./apply-defaults.js');

module.exports = function(time, options) {
	var defaults = {
		naturalInterpreter: false
	};

	const _options = applyDefaults(options, defaults)

	var _ms = Math.floor(time),
		_s = Math.floor(time / 1000),
		_m = Math.floor(_s / 60),
		_h = Math.floor(_m / 60);

	var arr = [_ms, _s, _m, _h],
		arr_l = arr.length;

	for (var i = 0; i < arr_l; i++) {
		if (arr[i] > 1) {
			if (i > 0 && i < arr_l - 1) {
				arr[i] = arr[i] - (arr[i + 1] * 60);
			} else if (i == 0) {
				arr[i] = arr[i] - (arr[i + 1] * 1000);
			}
			arr[i] = arr[i] < 10 ? '0' + arr[i] : arr[i];
		} else {
			arr[i] = '00'
		}
	}

	if (_options.naturalInterpreter) {
		if (
			parseInt(arr[3]) == 0 
			&& parseInt(arr[2]) == 0
			&& parseInt(arr[1]) == 0
		) {
			return String(parseInt(arr[0])) + ' ms'

		} else if (
			parseInt(arr[3]) == 0 
			&& parseInt(arr[2]) == 0
		) {
			return String(parseInt(arr[1])) + '.' +  String(parseInt(arr[0])) + ' s'

		} else if (
			parseInt(arr[3]) == 0
		) {
			return String(parseInt(arr[2])) + '.' +  String(parseInt(arr[1])) + ' min'

		} else {
			return String(parseInt(arr[3])) + '.' + String(parseInt(arr[2])) + ' h'

		}

	} else {
		return arr[3] + ':' + arr[2] + ':' + arr[1]
	}
}
